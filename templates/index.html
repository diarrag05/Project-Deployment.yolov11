<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YOLOv11 Segmentation - Home</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <nav class="navbar">
        <div class="navbar-container">
            <h1 class="logo">YOLOv11 Segmentation Platform</h1>
            <ul class="nav-links">
                <li><a href="/" class="active">Home</a></li>
                <li><a href="/analysis">Analysis</a></li>
                <li><a href="/dashboard">Dashboard</a></li>
                <li><a href="/feedback">Feedback</a></li>
                <li><a href="#" onclick="checkHealth()">Status</a></li>
            </ul>
        </div>
    </nav>

    <main class="container">
        <section class="hero">
            <h2>Chip Defect Detection & Analysis</h2>
            <p>Upload images to detect chips and calculate void rates using YOLOv11 segmentation</p>
        </section>

        <section class="upload-section">
            <div class="upload-box">
                <h3>Upload Image</h3>
                <div class="upload-area" id="uploadArea">
                    <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                    <p>Drag and drop your image here or click to select</p>
                    <input type="file" id="imageInput" accept="image/*" style="display: none;">
                </div>
                <div id="previewContainer" style="display: none;">
                    <img id="preview" alt="Preview" style="max-width: 300px; margin-top: 20px;">
                </div>
            </div>

            <div class="options-box">
                <h3>Inference Options</h3>
                <div class="form-group">
                    <label for="confidence">Confidence Threshold:</label>
                    <input type="range" id="confidence" min="0" max="1" step="0.05" value="0.5">
                    <span id="confidenceValue">0.50</span>
                </div>
                <button id="predictBtn" class="btn btn-primary" disabled>Run Inference</button>
                <button id="resetBtn" class="btn btn-secondary">Clear</button>
            </div>
        </section>

        <section id="resultsSection" class="results-section" style="display: none;">
            <h3>Inference Results</h3>
            <div class="results-container">
                <div class="result-image">
                    <h4>Original Image</h4>
                    <img id="originalImage" alt="Original">
                </div>
                <div class="result-image">
                    <h4>Segmentation Mask</h4>
                    <img id="maskImage" alt="Mask">
                </div>
            </div>

            <div class="statistics-box">
                <h4>Void Rate Analysis</h4>
                <div class="stats-grid">
                    <div class="stat-item">
                        <label>Chip Area (pixels):</label>
                        <span id="chipArea">0</span>
                    </div>
                    <div class="stat-item">
                        <label>Holes Area (pixels):</label>
                        <span id="holesArea">0</span>
                    </div>
                    <div class="stat-item highlight">
                        <label>Void Rate (%):</label>
                        <span id="voidRate">0.00</span>
                    </div>
                    <div class="stat-item">
                        <label>Chip Percentage:</label>
                        <span id="chipPercentage">0.00</span>
                    </div>
                    <div class="stat-item">
                        <label>Holes Percentage:</label>
                        <span id="holesPercentage">0.00</span>
                    </div>
                    <div class="stat-item">
                        <label>Confidence:</label>
                        <span id="confidence">0.00</span>
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button id="relabelBtn" class="btn btn-warning">Re-segment (SAM)</button>
                <button id="validateBtn" class="btn btn-success">Save Labels</button>
                <button id="exportBtn" class="btn btn-info">Export</button>
            </div>
        </section>

        <section class="batch-section">
            <h3>Batch Processing</h3>
            <div class="batch-box">
                <p>Process multiple images at once</p>
                <input type="file" id="batchInput" accept="image/*" multiple style="display: none;">
                <button id="batchSelectBtn" class="btn btn-primary">Select Images</button>
                <button id="batchProcessBtn" class="btn btn-primary" disabled>Process Batch</button>
                <div id="batchProgress" style="display: none;">
                    <progress id="batchProgressBar" max="100" value="0"></progress>
                    <p id="batchProgressText">0%</p>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 YOLOv11 Segmentation Platform | Powered by Ultralytics</p>
    </footer>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
